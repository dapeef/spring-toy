(()=>{"use strict";var t,i=(t=function(i,s){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s])},t(i,s)},function(i,s){if("function"!=typeof s&&null!==s)throw new TypeError("Class extends value "+String(s)+" is not a constructor or null");function e(){this.constructor=i}t(i,s),i.prototype=null===s?Object.create(s):(e.prototype=s.prototype,new e)}),s=function(){function t(t,i){void 0===t&&(t=0),void 0===i&&(i=0),this.x=t,this.y=i}return t.prototype.add=function(t){this.x+=t.x,this.y+=t.y},t.prototype.subtract=function(t){this.x-=t.x,this.y-=t.y},t.prototype.multiplyBy=function(t){this.x*=t,this.y*=t},t.prototype.normalize=function(){this.multiplyBy(1/this.length())},t.prototype.plus=function(i){return new t(this.x+i.x,this.y+i.y)},t.prototype.minus=function(i){return new t(this.x-i.x,this.y-i.y)},t.prototype.times=function(i){return new t(this.x*i,this.y*i)},t.prototype.length=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},t.prototype.normalized=function(){return this.times(1/this.length())},t.prototype.dot=function(t){return this.x*t.x+this.y*t.y},t.prototype.clamp=function(t){this.length()>t&&(this.normalize(),this.multiplyBy(t))},t.prototype.copy=function(){return new t(this.x,this.y)},t}(),e=function(){function t(t,i,e,o,n){void 0===t&&(t=new s(25,25)),void 0===i&&(i=1),void 0===e&&(e=1e-7),void 0===o&&(o=1),void 0===n&&(n=new s(50,50)),this._position=t,this.mass=i,this.stiffness=e,this.damping=o,this._size=n,this.isBeingDragged=!1,this.relativeMousePosition=new s,this.springs=[],this._velocity=new s}return Object.defineProperty(t.prototype,"position",{get:function(){return this._position},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"velocity",{get:function(){return this._velocity},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){return this._position.x-this._size.x/2},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this._position.x+this._size.x/2},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this._position.y-this._size.y/2},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this._position.y+this._size.y/2},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"minSize",{get:function(){return Math.min(this._size.x,this._size.y)},enumerable:!1,configurable:!0}),t.prototype.addSpring=function(t){this.springs.push(t)},t.prototype.update=function(i,e,o,h,r,a){var p=this;if(this.isBeingDragged){var u=this._position.copy();this._position=o.minus(this.relativeMousePosition),this._velocity=this._position.minus(u).times(1/e)}else{var c=new s;c.add(new s(0,this.mass*h)),this.springs.forEach((function(t){c.add(t.getForce(p))}));var m=[];this.left<=0&&m.push(new n(this,new t(new s(-this._size.x/2,this._position.y)),this._size.x)),this.right>=i.width&&m.push(new n(this,new t(new s(i.width+this._size.x/2,this._position.y)),this._size.x)),this.top<=0&&m.push(new n(this,new t(new s(this._position.x,-this._size.y/2)),this._size.y)),this.bottom>=i.height&&m.push(new n(this,new t(new s(this._position.x,i.height+this._size.y/2)),this._size.y)),m.forEach((function(t){c.add(t.getForce(p))}));var y=c.times(1/this.mass);this._velocity.add(y.times(e)),this._velocity.clamp(a),this._position.add(this._velocity.times(e)),this.right<=0&&(this._velocity.x=0,this._position.x=-this.size.x/2+1),this.left>=i.width&&(this._velocity.x=0,this._position.x=i.width+this.size.x/2-1),this.bottom<=0&&(this._velocity.y=0,this._position.y=-this.size.y/2+1),this.top>=i.height&&(this._velocity.y=0,this._position.y=i.height+this.size.y/2-1)}},t.prototype.draw=function(t){t.strokeStyle="black",t.beginPath(),t.roundRect(this.left,this.top,this._size.x,this._size.y,this.minSize/5),t.fill()},t}(),o=function(){function t(t,i,e,o,n){void 0===e&&(e=200),void 0===o&&(o=1e-4),void 0===n&&(n=.001),this.mass1=t,this.mass2=i,this.naturalLength=e,this.stiffness=o,this.damping=n,this.length=0,this.relativePos=new s,this.elasticForce=new s,this.dampingForce=new s,this.force=new s,this.defaultWidth=10,this.update()}return t.prototype.getForce=function(t){return t===this.mass2?this.force:this.force.times(-1)},t.prototype.update=function(){this.relativePos=this.mass1.position.minus(this.mass2.position),this.length=this.relativePos.length();var t=this.relativePos.normalized();this.elasticForce=t.times((this.length-this.naturalLength)*this.stiffness);var i=this.mass1.velocity.minus(this.mass2.velocity).dot(t);this.dampingForce=t.times(i*this.damping),this.force=this.elasticForce.plus(this.dampingForce)},t.prototype.draw=function(t){t.beginPath(),t.moveTo(this.mass1.position.x,this.mass1.position.y),t.lineTo(this.mass2.position.x,this.mass2.position.y),t.lineWidth=Math.min(this.defaultWidth*this.naturalLength/this.length,this.mass1.minSize,this.mass2.minSize),t.strokeStyle="gray",t.stroke()},t}(),n=function(t){function s(i,s,e,o,n){void 0===o&&(o=1e-5),void 0===n&&(n=.01);var h=t.call(this,s,i,e,o,n)||this;return h.mass1=i,h.mass2=s,h.naturalLength=e,h.stiffness=o,h.damping=n,h.hertzExponent=2,h.penaltyExponent=.5,h.update(),h}return i(s,t),s.prototype.update=function(){this.relativePos=this.mass1.position.minus(this.mass2.position),this.length=this.relativePos.length();var t=this.relativePos.normalized(),i=Math.pow(this.naturalLength-this.length,this.hertzExponent)*this.stiffness,s=1+1/Math.pow(this.length,this.penaltyExponent);this.elasticForce=t.times(i*s).times(-1);var e=this.mass1.velocity.minus(this.mass2.velocity).dot(t);this.dampingForce=t.times(e*this.damping),this.force=this.elasticForce.plus(this.dampingForce)},s}(o),h=function(){function t(t){this.canvas=t,this.isMouseDown=!1,this.mousePosition=new s,this.maxDeltaTime=50,this.gravity=5e-4,this.maxForce=.1,this.maxSpeed=1e4,this.ctx=t.getContext("2d"),this.lastTime=0,this.deltaTime=0,this.masses=[],this.springs=[]}return t.prototype.addMass=function(t){this.masses.push(t)},t.prototype.addSpring=function(t){this.springs.push(t),t.mass1.addSpring(t),t.mass2.addSpring(t)},t.prototype.mouseDown=function(t){var i=this;this.isMouseDown=!0,this.mousePosition.x=t.x,this.mousePosition.y=t.y,this.masses.forEach((function(s){s.position.x-s.size.x<=t.x&&s.position.x+s.size.x>=t.x&&s.position.y-s.size.y<=t.y&&s.position.y+s.size.y>=t.y&&(s.isBeingDragged=!0,s.relativeMousePosition=i.mousePosition.minus(s.position))}))},t.prototype.mouseMove=function(t){this.mousePosition.x=t.x,this.mousePosition.y=t.y},t.prototype.mouseUp=function(t){this.isMouseDown=!1,this.masses.forEach((function(t){return t.isBeingDragged=!1}))},t.prototype.start=function(){requestAnimationFrame(this.mainLoop.bind(this))},t.prototype.mainLoop=function(t){this.deltaTime=Math.min(t-this.lastTime,this.maxDeltaTime),this.lastTime=t,this.update(this.deltaTime),this.draw(),requestAnimationFrame(this.mainLoop.bind(this))},t.prototype.update=function(t){var i=this;this.masses.forEach((function(s){return s.update(i.canvas,t,i.mousePosition,i.gravity,i.maxForce,i.maxSpeed)})),this.springs.forEach((function(t){return t.update()}))},t.prototype.draw=function(){var t=this;this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.springs.forEach((function(i){return i.draw(t.ctx)})),this.masses.forEach((function(i){return i.draw(t.ctx)}))},t}(),r=document.getElementById("canvas");function a(){r.width=window.innerWidth,r.height=window.innerHeight}window.addEventListener("resize",a),a();var p=new h(r);r.onmousedown=p.mouseDown.bind(p),r.onmousemove=p.mouseMove.bind(p),r.onmouseup=p.mouseUp.bind(p);var u=new e(new s(15,30)),c=new e(new s(30,300)),m=new e(new s(300,30));p.addMass(u),p.addMass(c),p.addMass(m);var y=new o(u,c),d=new o(c,m),l=new o(u,m);p.addSpring(y),p.addSpring(d),p.addSpring(l),p.start()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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ckMsRUFBUSxHQUFJLEtBQ2pDcUQsRUFBUSxJQUFJaEIsRUFBSyxJQUFJckMsRUFBUSxHQUFJLE1BQ2pDdUcsRUFBUSxJQUFJbEUsRUFBSyxJQUFJckMsRUFBUSxJQUFLLEtBQ3RDa0csRUFBS25CLFFBQVEzQixHQUNiOEMsRUFBS25CLFFBQVExQixHQUNiNkMsRUFBS25CLFFBQVF3QixHQUViLElBQUlDLEVBQVUsSUFBSS9CLEVBQU9yQixFQUFPQyxHQUM1Qm9ELEVBQVUsSUFBSWhDLEVBQU9wQixFQUFPa0QsR0FDNUJHLEVBQVUsSUFBSWpDLEVBQU9yQixFQUFPbUQsR0FDaENMLEVBQUs3RSxVQUFVbUYsR0FDZk4sRUFBSzdFLFVBQVVvRixHQUNmUCxFQUFLN0UsVUFBVXFGLEdBRWZSLEVBQUtkLE8iLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zcHJpbmctdG95Ly4vc3JjL2NsYXNzZXMudHMiLCJ3ZWJwYWNrOi8vc3ByaW5nLXRveS8uL3NyYy9tYWluLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjbGFzcyBWZWN0b3IyIHtcclxuICAgIGNvbnN0cnVjdG9yKHB1YmxpYyB4Om51bWJlciA9IDAsIHB1YmxpYyB5Om51bWJlciA9IDApIHt9O1xyXG5cclxuICAgIHB1YmxpYyBhZGQodmVjdG9yOlZlY3RvcjIpOnZvaWQge1xyXG4gICAgICAgIC8vIEFkZCBhbm90aGVyIFZlY3RvcjIgdG8gdGhpcyBWZWN0b3IyXHJcbiAgICAgICAgdGhpcy54ICs9IHZlY3Rvci54O1xyXG4gICAgICAgIHRoaXMueSArPSB2ZWN0b3IueTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgcHVibGljIHN1YnRyYWN0KHZlY3RvcjpWZWN0b3IyKTp2b2lkIHtcclxuICAgICAgICAvLyBTdWJ0cmFjdCBhbm90aGVyIFZlY3RvcjIgZnJvbSB0aGlzIFZlY3RvcjJcclxuICAgICAgICB0aGlzLnggLT0gdmVjdG9yLng7XHJcbiAgICAgICAgdGhpcy55IC09IHZlY3Rvci55O1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBtdWx0aXBseUJ5KHNjYWxhcjpudW1iZXIpOnZvaWQge1xyXG4gICAgICAgIC8vIFN1bSB0aGlzIFZlY3RvcjIgd2l0aCB0aGUgbmVnYXRpdmUgb2YgYW5vdGhlciBhbmQgcmV0dXJuIGEgbmV3IFZlY3RvcjIgb2YgdGhlIHJlc3VsdFxyXG4gICAgICAgIHRoaXMueCAqPSBzY2FsYXJcclxuICAgICAgICB0aGlzLnkgKj0gc2NhbGFyO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBub3JtYWxpemUoKTp2b2lkIHtcclxuICAgICAgICB0aGlzLm11bHRpcGx5QnkoMS90aGlzLmxlbmd0aCgpKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgcGx1cyh2ZWN0b3I6VmVjdG9yMik6VmVjdG9yMiB7XHJcbiAgICAgICAgLy8gU3VtIHRoaXMgVmVjdG9yMiB3aXRoIGFub3RoZXIgYW5kIHJldHVybiBhIG5ldyBWZWN0b3IyIG9mIHRoZSByZXN1bHRcclxuICAgICAgICByZXR1cm4gbmV3IFZlY3RvcjIodGhpcy54ICsgdmVjdG9yLngsIHRoaXMueSArIHZlY3Rvci55KTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgcHVibGljIG1pbnVzKHZlY3RvcjpWZWN0b3IyKTpWZWN0b3IyIHtcclxuICAgICAgICAvLyBTdW0gdGhpcyBWZWN0b3IyIHdpdGggdGhlIG5lZ2F0aXZlIG9mIGFub3RoZXIgYW5kIHJldHVybiBhIG5ldyBWZWN0b3IyIG9mIHRoZSByZXN1bHRcclxuICAgICAgICByZXR1cm4gbmV3IFZlY3RvcjIodGhpcy54IC0gdmVjdG9yLngsIHRoaXMueSAtIHZlY3Rvci55KTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgdGltZXMoc2NhbGFyOm51bWJlcik6VmVjdG9yMiB7XHJcbiAgICAgICAgLy8gU3VtIHRoaXMgVmVjdG9yMiB3aXRoIHRoZSBuZWdhdGl2ZSBvZiBhbm90aGVyIGFuZCByZXR1cm4gYSBuZXcgVmVjdG9yMiBvZiB0aGUgcmVzdWx0XHJcbiAgICAgICAgcmV0dXJuIG5ldyBWZWN0b3IyKHRoaXMueCAqIHNjYWxhciwgdGhpcy55ICogc2NhbGFyKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgbGVuZ3RoKCk6bnVtYmVyIHtcclxuICAgICAgICAvLyBHZXQgbGVuZ3RoIG9mIHRoZSB2ZWN0b3JcclxuICAgICAgICByZXR1cm4gTWF0aC5zcXJ0KE1hdGgucG93KHRoaXMueCwgMikgKyBNYXRoLnBvdyh0aGlzLnksIDIpKVxyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBub3JtYWxpemVkKCk6VmVjdG9yMiB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMudGltZXMoMS90aGlzLmxlbmd0aCgpKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZG90KHZlY3RvcjpWZWN0b3IyKTpudW1iZXIge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnggKiB2ZWN0b3IueCArIHRoaXMueSAqIHZlY3Rvci55O1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBjbGFtcChtYWduaXR1ZGU6bnVtYmVyKTp2b2lkIHtcclxuICAgICAgICBpZiAodGhpcy5sZW5ndGgoKSA+IG1hZ25pdHVkZSkge1xyXG4gICAgICAgICAgICB0aGlzLm5vcm1hbGl6ZSgpXHJcbiAgICAgICAgICAgIHRoaXMubXVsdGlwbHlCeShtYWduaXR1ZGUpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgY29weSgpOlZlY3RvcjIge1xyXG4gICAgICAgIHJldHVybiBuZXcgVmVjdG9yMih0aGlzLngsIHRoaXMueSk7XHJcbiAgICB9XHJcbn1cclxuXHJcblxyXG5leHBvcnQgY2xhc3MgTWFzcyB7XHJcbiAgICBwcml2YXRlIHNwcmluZ3M6U3ByaW5nW107XHJcbiAgICBwcml2YXRlIF92ZWxvY2l0eTpWZWN0b3IyO1xyXG4gICAgcHVibGljIGlzQmVpbmdEcmFnZ2VkOmJvb2xlYW4gPSBmYWxzZTtcclxuICAgIHB1YmxpYyByZWxhdGl2ZU1vdXNlUG9zaXRpb246VmVjdG9yMiA9IG5ldyBWZWN0b3IyKCk7XHJcblxyXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBfcG9zaXRpb246VmVjdG9yMiA9IG5ldyBWZWN0b3IyKDI1LCAyNSksIHByaXZhdGUgbWFzczpudW1iZXIgPSAxLCBwcml2YXRlIHN0aWZmbmVzczpudW1iZXIgPSAxZS03LCBwcml2YXRlIGRhbXBpbmc6bnVtYmVyID0gMWUwLCBwcml2YXRlIF9zaXplOlZlY3RvcjIgPSBuZXcgVmVjdG9yMig1MCwgNTApKSB7XHJcbiAgICAgICAgdGhpcy5zcHJpbmdzID0gW107XHJcbiAgICAgICAgdGhpcy5fdmVsb2NpdHkgPSBuZXcgVmVjdG9yMigpO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICBwdWJsaWMgZ2V0IHBvc2l0aW9uKCkgOiBWZWN0b3IyIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fcG9zaXRpb247XHJcbiAgICB9XHJcbiAgICBwdWJsaWMgZ2V0IHZlbG9jaXR5KCkgOiBWZWN0b3IyIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fdmVsb2NpdHk7XHJcbiAgICB9XHJcbiAgICBwdWJsaWMgZ2V0IHNpemUoKSA6IFZlY3RvcjIge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9zaXplO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBwdWJsaWMgZ2V0IGxlZnQoKSA6IG51bWJlciB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3Bvc2l0aW9uLnggLSB0aGlzLl9zaXplLngvMjtcclxuICAgIH1cclxuICAgIHB1YmxpYyBnZXQgcmlnaHQoKSA6IG51bWJlciB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3Bvc2l0aW9uLnggKyB0aGlzLl9zaXplLngvMjtcclxuICAgIH1cclxuICAgIHB1YmxpYyBnZXQgdG9wKCkgOiBudW1iZXIge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9wb3NpdGlvbi55IC0gdGhpcy5fc2l6ZS55LzI7XHJcbiAgICB9XHJcbiAgICBwdWJsaWMgZ2V0IGJvdHRvbSgpIDogbnVtYmVyIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fcG9zaXRpb24ueSArIHRoaXMuX3NpemUueS8yO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBnZXQgbWluU2l6ZSgpIDogbnVtYmVyIHtcclxuICAgICAgICByZXR1cm4gTWF0aC5taW4odGhpcy5fc2l6ZS54LCB0aGlzLl9zaXplLnkpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBhZGRTcHJpbmcoc3ByaW5nOlNwcmluZyk6dm9pZCB7XHJcbiAgICAgICAgdGhpcy5zcHJpbmdzLnB1c2goc3ByaW5nKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgcHVibGljIHVwZGF0ZShjYW52YXM6SFRNTENhbnZhc0VsZW1lbnQsIGRlbHRhVGltZTpudW1iZXIsIG1vdXNlUG9zaXRpb246VmVjdG9yMiwgZ3Jhdml0eTpudW1iZXIsIG1heEZvcmNlOm51bWJlciwgbWF4U3BlZWQ6bnVtYmVyKTp2b2lkIHtcclxuICAgICAgICBpZiAodGhpcy5pc0JlaW5nRHJhZ2dlZCkge1xyXG4gICAgICAgICAgICBjb25zdCBvbGRQb3NpdGlvbiA9IHRoaXMuX3Bvc2l0aW9uLmNvcHkoKTtcclxuICAgICAgICAgICAgdGhpcy5fcG9zaXRpb24gPSBtb3VzZVBvc2l0aW9uLm1pbnVzKHRoaXMucmVsYXRpdmVNb3VzZVBvc2l0aW9uKTtcclxuICAgICAgICAgICAgdGhpcy5fdmVsb2NpdHkgPSB0aGlzLl9wb3NpdGlvbi5taW51cyhvbGRQb3NpdGlvbikudGltZXMoMS9kZWx0YVRpbWUpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGxldCBmb3JjZSA9IG5ldyBWZWN0b3IyKCk7XHJcbiAgICAgICAgICAgIC8vIEdyYXZpdHlcclxuICAgICAgICAgICAgZm9yY2UuYWRkKG5ldyBWZWN0b3IyKDAsIHRoaXMubWFzcyAqIGdyYXZpdHkpKTtcclxuICAgICAgICAgICAgLy8gU3ByaW5nICBcclxuICAgICAgICAgICAgdGhpcy5zcHJpbmdzLmZvckVhY2goc3ByaW5nID0+IHtmb3JjZS5hZGQoc3ByaW5nLmdldEZvcmNlKHRoaXMpKX0pO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gQm91bmNlIG9mZiB3YWxsc1xyXG4gICAgICAgICAgICBsZXQgY29udGFjdFNwcmluZ3M6Q29udGFjdFNwcmluZ1tdID0gW107XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmxlZnQgPD0gMCkgICAgICAgICAgICAgICAgIHtjb250YWN0U3ByaW5ncy5wdXNoKG5ldyBDb250YWN0U3ByaW5nKHRoaXMsIG5ldyBNYXNzKG5ldyBWZWN0b3IyKC10aGlzLl9zaXplLngvMiAgICAgICAgICAgICAgICAsIHRoaXMuX3Bvc2l0aW9uLnkpKSwgdGhpcy5fc2l6ZS54KSl9IC8vIExlZnRcclxuICAgICAgICAgICAgaWYgKHRoaXMucmlnaHQgPj0gY2FudmFzLndpZHRoKSAgICAge2NvbnRhY3RTcHJpbmdzLnB1c2gobmV3IENvbnRhY3RTcHJpbmcodGhpcywgbmV3IE1hc3MobmV3IFZlY3RvcjIoY2FudmFzLndpZHRoK3RoaXMuX3NpemUueC8yICAgICwgdGhpcy5fcG9zaXRpb24ueSkpLCB0aGlzLl9zaXplLngpKX0gLy8gUmlnaHRcclxuICAgICAgICAgICAgaWYgKHRoaXMudG9wIDw9IDApICAgICAgICAgICAgICAgICAge2NvbnRhY3RTcHJpbmdzLnB1c2gobmV3IENvbnRhY3RTcHJpbmcodGhpcywgbmV3IE1hc3MobmV3IFZlY3RvcjIodGhpcy5fcG9zaXRpb24ueCwgLXRoaXMuX3NpemUueS8yICAgICAgICAgICAgICAgICkpLCB0aGlzLl9zaXplLnkpKX0gLy8gVG9wXHJcbiAgICAgICAgICAgIGlmICh0aGlzLmJvdHRvbSA+PSBjYW52YXMuaGVpZ2h0KSAgIHtjb250YWN0U3ByaW5ncy5wdXNoKG5ldyBDb250YWN0U3ByaW5nKHRoaXMsIG5ldyBNYXNzKG5ldyBWZWN0b3IyKHRoaXMuX3Bvc2l0aW9uLngsIGNhbnZhcy5oZWlnaHQrdGhpcy5fc2l6ZS55LzIgICApKSwgdGhpcy5fc2l6ZS55KSl9IC8vIEJvdHRvbVxyXG4gICAgICAgICAgICBjb250YWN0U3ByaW5ncy5mb3JFYWNoKHNwcmluZyA9PiB7XHJcbiAgICAgICAgICAgICAgICBmb3JjZS5hZGQoc3ByaW5nLmdldEZvcmNlKHRoaXMpKX0pO1xyXG5cclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBmb3JjZS5jbGFtcChtYXhGb3JjZSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBsZXQgYWNjZWxlcmF0aW9uOlZlY3RvcjIgPSBmb3JjZS50aW1lcygxL3RoaXMubWFzcyk7XHJcbiAgICAgICAgICAgIHRoaXMuX3ZlbG9jaXR5LmFkZChhY2NlbGVyYXRpb24udGltZXMoZGVsdGFUaW1lKSk7XHJcbiAgICAgICAgICAgIHRoaXMuX3ZlbG9jaXR5LmNsYW1wKG1heFNwZWVkKTtcclxuICAgICAgICAgICAgdGhpcy5fcG9zaXRpb24uYWRkKHRoaXMuX3ZlbG9jaXR5LnRpbWVzKGRlbHRhVGltZSkpO1xyXG5cclxuICAgICAgICAgICAgLy8gUHV0IGhhcmQgbGltaXQgb24gd2FsbHNcclxuICAgICAgICAgICAgaWYgKHRoaXMucmlnaHQgPD0gMCkgICAgICAgICAgICB7dGhpcy5fdmVsb2NpdHkueCA9IDA7IHRoaXMuX3Bvc2l0aW9uLnggPSAtdGhpcy5zaXplLngvMiArIDF9IC8vIExlZnRcclxuICAgICAgICAgICAgaWYgKHRoaXMubGVmdCA+PSBjYW52YXMud2lkdGgpICB7dGhpcy5fdmVsb2NpdHkueCA9IDA7IHRoaXMuX3Bvc2l0aW9uLnggPSBjYW52YXMud2lkdGggKyB0aGlzLnNpemUueC8yIC0gMX0gLy8gUmlnaHRcclxuICAgICAgICAgICAgaWYgKHRoaXMuYm90dG9tIDw9IDApICAgICAgICAgICB7dGhpcy5fdmVsb2NpdHkueSA9IDA7IHRoaXMuX3Bvc2l0aW9uLnkgPSAtdGhpcy5zaXplLnkvMiArIDF9IC8vIFRvcFxyXG4gICAgICAgICAgICBpZiAodGhpcy50b3AgPj0gY2FudmFzLmhlaWdodCkgIHt0aGlzLl92ZWxvY2l0eS55ID0gMDsgdGhpcy5fcG9zaXRpb24ueSA9IGNhbnZhcy5oZWlnaHQgKyB0aGlzLnNpemUueS8yIC0gMX0gLy8gQm90dG9tXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBkcmF3KGN0eDpDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQpOnZvaWQge1xyXG4gICAgICAgIGN0eC5zdHJva2VTdHlsZSA9IFwiYmxhY2tcIjtcclxuICAgICAgICBjdHguYmVnaW5QYXRoKCk7XHJcbiAgICAgICAgY3R4LnJvdW5kUmVjdChcclxuICAgICAgICAgICAgdGhpcy5sZWZ0LFxyXG4gICAgICAgICAgICB0aGlzLnRvcCxcclxuICAgICAgICAgICAgdGhpcy5fc2l6ZS54LFxyXG4gICAgICAgICAgICB0aGlzLl9zaXplLnksXHJcbiAgICAgICAgICAgIHRoaXMubWluU2l6ZSAvIDVcclxuICAgICAgICApO1xyXG4gICAgICAgIGN0eC5maWxsKCk7XHJcbiAgICB9XHJcbn1cclxuXHJcblxyXG5leHBvcnQgY2xhc3MgU3ByaW5nIHtcclxuICAgIHByb3RlY3RlZCBsZW5ndGg6bnVtYmVyID0gMDtcclxuICAgIHByb3RlY3RlZCByZWxhdGl2ZVBvczpWZWN0b3IyID0gbmV3IFZlY3RvcjIoKTtcclxuICAgIHByb3RlY3RlZCBlbGFzdGljRm9yY2U6VmVjdG9yMiA9IG5ldyBWZWN0b3IyKCk7XHJcbiAgICBwcm90ZWN0ZWQgZGFtcGluZ0ZvcmNlOlZlY3RvcjIgPSBuZXcgVmVjdG9yMigpO1xyXG4gICAgcHJvdGVjdGVkIGZvcmNlOlZlY3RvcjIgPSBuZXcgVmVjdG9yMigpO1xyXG5cclxuICAgIHByb3RlY3RlZCBkZWZhdWx0V2lkdGggPSAxMDtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihwdWJsaWMgbWFzczE6TWFzcywgcHVibGljIG1hc3MyOk1hc3MsIHByb3RlY3RlZCBuYXR1cmFsTGVuZ3RoID0gMjAwLCBwcm90ZWN0ZWQgc3RpZmZuZXNzOm51bWJlciA9IDFlLTQsIHByb3RlY3RlZCBkYW1waW5nOm51bWJlciA9IDFlLTMpIHtcclxuICAgICAgICB0aGlzLnVwZGF0ZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBnZXRGb3JjZShkYXR1bU1hc3M6TWFzcyk6VmVjdG9yMiB7XHJcbiAgICAgICAgaWYgKGRhdHVtTWFzcyA9PT0gdGhpcy5tYXNzMikge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5mb3JjZTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5mb3JjZS50aW1lcygtMSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyB1cGRhdGUoKTp2b2lkIHtcclxuICAgICAgICB0aGlzLnJlbGF0aXZlUG9zID0gdGhpcy5tYXNzMS5wb3NpdGlvbi5taW51cyh0aGlzLm1hc3MyLnBvc2l0aW9uKTtcclxuICAgICAgICB0aGlzLmxlbmd0aCA9IHRoaXMucmVsYXRpdmVQb3MubGVuZ3RoKCk7XHJcbiAgICAgICAgbGV0IGRpcmVjdGlvbiA9IHRoaXMucmVsYXRpdmVQb3Mubm9ybWFsaXplZCgpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIEVsYXN0aWNzXHJcbiAgICAgICAgdGhpcy5lbGFzdGljRm9yY2UgPSBkaXJlY3Rpb24udGltZXMoKHRoaXMubGVuZ3RoIC0gdGhpcy5uYXR1cmFsTGVuZ3RoKSAqIHRoaXMuc3RpZmZuZXNzKVxyXG5cclxuICAgICAgICAvLyBEYW1waW5nXHJcbiAgICAgICAgbGV0IHJlbGF0aXZlU3BlZWQ6bnVtYmVyID0gdGhpcy5tYXNzMS52ZWxvY2l0eS5taW51cyh0aGlzLm1hc3MyLnZlbG9jaXR5KS5kb3QoZGlyZWN0aW9uKTtcclxuICAgICAgICB0aGlzLmRhbXBpbmdGb3JjZSA9IGRpcmVjdGlvbi50aW1lcyhyZWxhdGl2ZVNwZWVkICogdGhpcy5kYW1waW5nKVxyXG5cclxuICAgICAgICAvLyBUb3RhbCBmb3JjZVxyXG4gICAgICAgIHRoaXMuZm9yY2UgPSB0aGlzLmVsYXN0aWNGb3JjZS5wbHVzKHRoaXMuZGFtcGluZ0ZvcmNlKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZHJhdyhjdHg6Q2FudmFzUmVuZGVyaW5nQ29udGV4dDJEKTp2b2lkIHtcclxuICAgICAgICBjdHguYmVnaW5QYXRoKCk7XHJcblxyXG4gICAgICAgIGN0eC5tb3ZlVG8odGhpcy5tYXNzMS5wb3NpdGlvbi54LCB0aGlzLm1hc3MxLnBvc2l0aW9uLnkpO1xyXG4gICAgICAgIGN0eC5saW5lVG8odGhpcy5tYXNzMi5wb3NpdGlvbi54LCB0aGlzLm1hc3MyLnBvc2l0aW9uLnkpO1xyXG5cclxuICAgICAgICBjdHgubGluZVdpZHRoID0gTWF0aC5taW4odGhpcy5kZWZhdWx0V2lkdGggKiB0aGlzLm5hdHVyYWxMZW5ndGggLyB0aGlzLmxlbmd0aCwgdGhpcy5tYXNzMS5taW5TaXplLCB0aGlzLm1hc3MyLm1pblNpemUpO1xyXG4gICAgICAgIGN0eC5zdHJva2VTdHlsZSA9ICdncmF5JztcclxuXHJcbiAgICAgICAgY3R4LnN0cm9rZSgpO1xyXG4gICAgfVxyXG59XHJcblxyXG5jbGFzcyBDb250YWN0U3ByaW5nIGV4dGVuZHMgU3ByaW5nIHtcclxuICAgIHByaXZhdGUgaGVydHpFeHBvbmVudDpudW1iZXIgPSAyO1xyXG4gICAgcHJpdmF0ZSBwZW5hbHR5RXhwb25lbnQ6bnVtYmVyID0gLjU7XHJcblxyXG4gICAgY29uc3RydWN0b3IocHVibGljIG1hc3MxOk1hc3MsIHB1YmxpYyBtYXNzMjpNYXNzLCBwcm90ZWN0ZWQgbmF0dXJhbExlbmd0aDpudW1iZXIsIHByb3RlY3RlZCBzdGlmZm5lc3M6bnVtYmVyID0gMWUtNSwgcHJvdGVjdGVkIGRhbXBpbmc6bnVtYmVyID0gMWUtMikge1xyXG4gICAgICAgIHN1cGVyKG1hc3MyLCBtYXNzMSwgbmF0dXJhbExlbmd0aCwgc3RpZmZuZXNzLCBkYW1waW5nKTtcclxuICAgICAgICB0aGlzLnVwZGF0ZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyB1cGRhdGUoKTp2b2lkIHtcclxuICAgICAgICB0aGlzLnJlbGF0aXZlUG9zID0gdGhpcy5tYXNzMS5wb3NpdGlvbi5taW51cyh0aGlzLm1hc3MyLnBvc2l0aW9uKTtcclxuICAgICAgICB0aGlzLmxlbmd0aCA9IHRoaXMucmVsYXRpdmVQb3MubGVuZ3RoKCk7XHJcbiAgICAgICAgbGV0IGRpcmVjdGlvbiA9IHRoaXMucmVsYXRpdmVQb3Mubm9ybWFsaXplZCgpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIEVsYXN0aWNzXHJcbiAgICAgICAgY29uc3QgaG9va2UgPSBNYXRoLnBvdyh0aGlzLm5hdHVyYWxMZW5ndGggLSB0aGlzLmxlbmd0aCwgdGhpcy5oZXJ0ekV4cG9uZW50KSAqIHRoaXMuc3RpZmZuZXNzO1xyXG4gICAgICAgIGNvbnN0IHBlbmFsdHkgPSAxICsgMSAvIE1hdGgucG93KHRoaXMubGVuZ3RoLCB0aGlzLnBlbmFsdHlFeHBvbmVudCk7XHJcbiAgICAgICAgdGhpcy5lbGFzdGljRm9yY2UgPSBkaXJlY3Rpb24udGltZXMoaG9va2UgKiBwZW5hbHR5KS50aW1lcygtMSk7XHJcblxyXG4gICAgICAgIC8vIERhbXBpbmdcclxuICAgICAgICBsZXQgcmVsYXRpdmVTcGVlZDpudW1iZXIgPSB0aGlzLm1hc3MxLnZlbG9jaXR5Lm1pbnVzKHRoaXMubWFzczIudmVsb2NpdHkpLmRvdChkaXJlY3Rpb24pO1xyXG4gICAgICAgIHRoaXMuZGFtcGluZ0ZvcmNlID0gZGlyZWN0aW9uLnRpbWVzKHJlbGF0aXZlU3BlZWQgKiB0aGlzLmRhbXBpbmcpXHJcblxyXG4gICAgICAgIC8vIFRvdGFsIGZvcmNlXHJcbiAgICAgICAgdGhpcy5mb3JjZSA9IHRoaXMuZWxhc3RpY0ZvcmNlLnBsdXModGhpcy5kYW1waW5nRm9yY2UpO1xyXG4gICAgfVxyXG59XHJcblxyXG5cclxuZXhwb3J0IGNsYXNzIEdhbWUge1xyXG4gICAgcHJpdmF0ZSBjdHg6Q2FudmFzUmVuZGVyaW5nQ29udGV4dDJEO1xyXG4gICAgcHJpdmF0ZSBpc01vdXNlRG93bjpib29sZWFuID0gZmFsc2U7XHJcbiAgICBwcml2YXRlIG1vdXNlUG9zaXRpb24gPSBuZXcgVmVjdG9yMigpO1xyXG5cclxuICAgIHByaXZhdGUgbGFzdFRpbWU6bnVtYmVyOyAvLyBtaWxsaXNlY29uZHNcclxuICAgIHByaXZhdGUgZGVsdGFUaW1lOm51bWJlcjsgLy8gbWlsbGlzZWNvbmRzXHJcbiAgICBwcml2YXRlIG1heERlbHRhVGltZTpudW1iZXIgPSA1MDsgLy9taWxsaXNlY29uZHNcclxuICAgIHByaXZhdGUgbWFzc2VzOk1hc3NbXTtcclxuICAgIHByaXZhdGUgc3ByaW5nczpTcHJpbmdbXTtcclxuXHJcbiAgICBwcml2YXRlIGdyYXZpdHk6bnVtYmVyID0gNWUtNDsgLy8gcGl4ZWxzL21zZWMvbXNlY1xyXG4gICAgcHJpdmF0ZSBtYXhGb3JjZTpudW1iZXIgPSAxZS0xO1xyXG4gICAgcHJpdmF0ZSBtYXhTcGVlZDpudW1iZXIgPSAxZTQ7XHJcblxyXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBjYW52YXM6SFRNTENhbnZhc0VsZW1lbnQpIHtcclxuICAgICAgICB0aGlzLmN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIikgYXMgQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJEO1xyXG5cclxuICAgICAgICB0aGlzLmxhc3RUaW1lID0gMDtcclxuICAgICAgICB0aGlzLmRlbHRhVGltZSA9IDA7XHJcblxyXG4gICAgICAgIHRoaXMubWFzc2VzID0gW107XHJcbiAgICAgICAgdGhpcy5zcHJpbmdzID0gW107XHJcbiAgICB9XHJcblxyXG5cclxuICAgIHB1YmxpYyBhZGRNYXNzKG1hc3M6TWFzcyk6dm9pZCB7XHJcbiAgICAgICAgdGhpcy5tYXNzZXMucHVzaChtYXNzKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgYWRkU3ByaW5nKHNwcmluZzpTcHJpbmcpOnZvaWQge1xyXG4gICAgICAgIHRoaXMuc3ByaW5ncy5wdXNoKHNwcmluZyk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgc3ByaW5nLm1hc3MxLmFkZFNwcmluZyhzcHJpbmcpO1xyXG4gICAgICAgIHNwcmluZy5tYXNzMi5hZGRTcHJpbmcoc3ByaW5nKTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgcHVibGljIG1vdXNlRG93bihldnQ6TW91c2VFdmVudCk6dm9pZCB7XHJcbiAgICAgICAgdGhpcy5pc01vdXNlRG93biA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5tb3VzZVBvc2l0aW9uLnggPSBldnQueDtcclxuICAgICAgICB0aGlzLm1vdXNlUG9zaXRpb24ueSA9IGV2dC55O1xyXG5cclxuICAgICAgICAvLyBXb3JrIG91dCB3aGV0aGVyIHRoZSBtb3VzZSBjbGljayB3YXMgd2l0aGluIGFueSBvZiB0aGUgbWFzc2VzXHJcbiAgICAgICAgdGhpcy5tYXNzZXMuZm9yRWFjaChtYXNzID0+IHtcclxuICAgICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAgICAgbWFzcy5wb3NpdGlvbi54IC0gbWFzcy5zaXplLnggPD0gZXZ0LnggJiZcclxuICAgICAgICAgICAgICAgIG1hc3MucG9zaXRpb24ueCArIG1hc3Muc2l6ZS54ID49IGV2dC54ICYmXHJcbiAgICAgICAgICAgICAgICBtYXNzLnBvc2l0aW9uLnkgLSBtYXNzLnNpemUueSA8PSBldnQueSAmJlxyXG4gICAgICAgICAgICAgICAgbWFzcy5wb3NpdGlvbi55ICsgbWFzcy5zaXplLnkgPj0gZXZ0LnkgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbWFzcy5pc0JlaW5nRHJhZ2dlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgbWFzcy5yZWxhdGl2ZU1vdXNlUG9zaXRpb24gPSB0aGlzLm1vdXNlUG9zaXRpb24ubWludXMobWFzcy5wb3NpdGlvbik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuICAgIHB1YmxpYyBtb3VzZU1vdmUoZXZ0Ok1vdXNlRXZlbnQpOnZvaWQge1xyXG4gICAgICAgIHRoaXMubW91c2VQb3NpdGlvbi54ID0gZXZ0Lng7XHJcbiAgICAgICAgdGhpcy5tb3VzZVBvc2l0aW9uLnkgPSBldnQueTtcclxuICAgIH1cclxuICAgIHB1YmxpYyBtb3VzZVVwKGV2dDpNb3VzZUV2ZW50KTp2b2lkIHtcclxuICAgICAgICB0aGlzLmlzTW91c2VEb3duID0gZmFsc2U7XHJcblxyXG4gICAgICAgIHRoaXMubWFzc2VzLmZvckVhY2gobWFzcyA9PiBtYXNzLmlzQmVpbmdEcmFnZ2VkID0gZmFsc2UpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBzdGFydCgpOnZvaWQge1xyXG4gICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSh0aGlzLm1haW5Mb29wLmJpbmQodGhpcykpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgbWFpbkxvb3AoY3VycmVudFRpbWU6bnVtYmVyKTp2b2lkIHtcclxuICAgICAgICB0aGlzLmRlbHRhVGltZSA9IE1hdGgubWluKGN1cnJlbnRUaW1lIC0gdGhpcy5sYXN0VGltZSwgdGhpcy5tYXhEZWx0YVRpbWUpO1xyXG4gICAgICAgIHRoaXMubGFzdFRpbWUgPSBjdXJyZW50VGltZTtcclxuXHJcbiAgICAgICAgdGhpcy51cGRhdGUodGhpcy5kZWx0YVRpbWUpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHRoaXMuZHJhdygpO1xyXG5cclxuICAgICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGhpcy5tYWluTG9vcC5iaW5kKHRoaXMpKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHVwZGF0ZShkZWx0YVRpbWU6bnVtYmVyKTp2b2lkIHtcclxuICAgICAgICB0aGlzLm1hc3Nlcy5mb3JFYWNoKChtYXNzKSA9PiBtYXNzLnVwZGF0ZSh0aGlzLmNhbnZhcywgZGVsdGFUaW1lLCB0aGlzLm1vdXNlUG9zaXRpb24sIHRoaXMuZ3Jhdml0eSwgdGhpcy5tYXhGb3JjZSwgdGhpcy5tYXhTcGVlZCkpO1xyXG4gICAgICAgIHRoaXMuc3ByaW5ncy5mb3JFYWNoKChzcHJpbmcpID0+IHNwcmluZy51cGRhdGUoKSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBkcmF3KCk6dm9pZCB7XHJcbiAgICAgICAgLy8gQ2xlYXIgc2NyZWVuXHJcbiAgICAgICAgdGhpcy5jdHguY2xlYXJSZWN0KDAsIDAsIHRoaXMuY2FudmFzLndpZHRoLCB0aGlzLmNhbnZhcy5oZWlnaHQpO1xyXG5cclxuICAgICAgICB0aGlzLnNwcmluZ3MuZm9yRWFjaCgoc3RyaW5nKSA9PiBzdHJpbmcuZHJhdyh0aGlzLmN0eCkpO1xyXG4gICAgICAgIHRoaXMubWFzc2VzLmZvckVhY2goKG1hc3MpID0+IG1hc3MuZHJhdyh0aGlzLmN0eCkpO1xyXG4gICAgfVxyXG59XHJcbiIsImltcG9ydCB7IEdhbWUsIE1hc3MsIFNwcmluZywgVmVjdG9yMiB9IGZyb20gXCIuL2NsYXNzZXNcIjtcclxuXHJcbmNvbnN0IGNhbnZhcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY2FudmFzXCIpIGFzIEhUTUxDYW52YXNFbGVtZW50O1xyXG5cclxuZnVuY3Rpb24gcmVzaXplQ2FudmFzKCk6IHZvaWQge1xyXG4gICAgY2FudmFzLndpZHRoICA9IHdpbmRvdy5pbm5lcldpZHRoO1xyXG4gICAgY2FudmFzLmhlaWdodCA9IHdpbmRvdy5pbm5lckhlaWdodDtcclxufVxyXG5cclxud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIHJlc2l6ZUNhbnZhcylcclxucmVzaXplQ2FudmFzKClcclxuXHJcblxyXG5jb25zdCBnYW1lID0gbmV3IEdhbWUoY2FudmFzKTtcclxuXHJcbmNhbnZhcy5vbm1vdXNlZG93biA9IGdhbWUubW91c2VEb3duLmJpbmQoZ2FtZSk7XHJcbmNhbnZhcy5vbm1vdXNlbW92ZSA9IGdhbWUubW91c2VNb3ZlLmJpbmQoZ2FtZSk7XHJcbmNhbnZhcy5vbm1vdXNldXAgPSBnYW1lLm1vdXNlVXAuYmluZChnYW1lKTtcclxuXHJcbmxldCBtYXNzMSA9IG5ldyBNYXNzKG5ldyBWZWN0b3IyKDE1LCAzMCkpO1xyXG5sZXQgbWFzczIgPSBuZXcgTWFzcyhuZXcgVmVjdG9yMigzMCwgMzAwKSk7XHJcbmxldCBtYXNzMyA9IG5ldyBNYXNzKG5ldyBWZWN0b3IyKDMwMCwgMzApKTtcclxuZ2FtZS5hZGRNYXNzKG1hc3MxKTtcclxuZ2FtZS5hZGRNYXNzKG1hc3MyKTtcclxuZ2FtZS5hZGRNYXNzKG1hc3MzKTtcclxuXHJcbmxldCBzcHJpbmcxID0gbmV3IFNwcmluZyhtYXNzMSwgbWFzczIpO1xyXG5sZXQgc3ByaW5nMiA9IG5ldyBTcHJpbmcobWFzczIsIG1hc3MzKTtcclxubGV0IHNwcmluZzMgPSBuZXcgU3ByaW5nKG1hc3MxLCBtYXNzMyk7XHJcbmdhbWUuYWRkU3ByaW5nKHNwcmluZzEpO1xyXG5nYW1lLmFkZFNwcmluZyhzcHJpbmcyKTtcclxuZ2FtZS5hZGRTcHJpbmcoc3ByaW5nMyk7XHJcblxyXG5nYW1lLnN0YXJ0KCk7XHJcbiJdLCJuYW1lcyI6WyJ4IiwieSIsImFkZCIsInZlY3RvciIsInRoaXMiLCJzdWJ0cmFjdCIsIm11bHRpcGx5QnkiLCJzY2FsYXIiLCJub3JtYWxpemUiLCJsZW5ndGgiLCJwbHVzIiwiVmVjdG9yMiIsIm1pbnVzIiwidGltZXMiLCJNYXRoIiwic3FydCIsInBvdyIsIm5vcm1hbGl6ZWQiLCJkb3QiLCJjbGFtcCIsIm1hZ25pdHVkZSIsImNvcHkiLCJfcG9zaXRpb24iLCJtYXNzIiwic3RpZmZuZXNzIiwiZGFtcGluZyIsIl9zaXplIiwiaXNCZWluZ0RyYWdnZWQiLCJyZWxhdGl2ZU1vdXNlUG9zaXRpb24iLCJzcHJpbmdzIiwiX3ZlbG9jaXR5IiwibWluIiwiYWRkU3ByaW5nIiwic3ByaW5nIiwicHVzaCIsInVwZGF0ZSIsImNhbnZhcyIsImRlbHRhVGltZSIsIm1vdXNlUG9zaXRpb24iLCJncmF2aXR5IiwibWF4Rm9yY2UiLCJtYXhTcGVlZCIsIm9sZFBvc2l0aW9uIiwiZm9yRWFjaCIsImdldEZvcmNlIiwiY29udGFjdFNwcmluZ3MiLCJsZWZ0IiwiQ29udGFjdFNwcmluZyIsIk1hc3MiLCJyaWdodCIsIndpZHRoIiwidG9wIiwiYm90dG9tIiwiaGVpZ2h0IiwiYWNjZWxlcmF0aW9uIiwic2l6ZSIsImRyYXciLCJjdHgiLCJzdHJva2VTdHlsZSIsImJlZ2luUGF0aCIsInJvdW5kUmVjdCIsIm1pblNpemUiLCJmaWxsIiwibWFzczEiLCJtYXNzMiIsIm5hdHVyYWxMZW5ndGgiLCJyZWxhdGl2ZVBvcyIsImVsYXN0aWNGb3JjZSIsImRhbXBpbmdGb3JjZSIsImZvcmNlIiwiZGVmYXVsdFdpZHRoIiwiZGF0dW1NYXNzIiwicG9zaXRpb24iLCJkaXJlY3Rpb24iLCJyZWxhdGl2ZVNwZWVkIiwidmVsb2NpdHkiLCJtb3ZlVG8iLCJsaW5lVG8iLCJsaW5lV2lkdGgiLCJzdHJva2UiLCJoZXJ0ekV4cG9uZW50IiwicGVuYWx0eUV4cG9uZW50IiwiaG9va2UiLCJwZW5hbHR5IiwiU3ByaW5nIiwiaXNNb3VzZURvd24iLCJtYXhEZWx0YVRpbWUiLCJnZXRDb250ZXh0IiwibGFzdFRpbWUiLCJtYXNzZXMiLCJhZGRNYXNzIiwibW91c2VEb3duIiwiZXZ0IiwibW91c2VNb3ZlIiwibW91c2VVcCIsInN0YXJ0IiwicmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwibWFpbkxvb3AiLCJiaW5kIiwiY3VycmVudFRpbWUiLCJjbGVhclJlY3QiLCJzdHJpbmciLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwicmVzaXplQ2FudmFzIiwid2luZG93IiwiaW5uZXJXaWR0aCIsImlubmVySGVpZ2h0IiwiYWRkRXZlbnRMaXN0ZW5lciIsImdhbWUiLCJHYW1lIiwib25tb3VzZWRvd24iLCJvbm1vdXNlbW92ZSIsIm9ubW91c2V1cCIsIm1hc3MzIiwic3ByaW5nMSIsInNwcmluZzIiLCJzcHJpbmczIl0sInNvdXJjZVJvb3QiOiIifQ==